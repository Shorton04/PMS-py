*---------------------------------------------------------------------*
* Date-Time filter
* Always allow REMOVE for TECO / LOCKED
*---------------------------------------------------------------------*
IF lv_teco_active = abap_true OR lv_locked_active = abap_true.
  " Always process TECO / LOCKED (even outside time window)
ELSE.
  IF lv_jcds_ts IS INITIAL AND lv_cdhdr_ts IS INITIAL.
    RETURN.
  ENDIF.
ENDIF.



*---------------------------------------------------------------------*
* Get status profile
*---------------------------------------------------------------------*
DATA lv_stsma TYPE tj30-stsma.

SELECT SINGLE stsma
  INTO lv_stsma
  FROM jest
 WHERE objnr = <ls_output_row>-MaintenanceOrder.

*---------------------------------------------------------------------*
* Remove CMXS
*---------------------------------------------------------------------*
APPEND VALUE #(
  user_st_text = 'CMXS'
  inactive     = 'X'
  langu        = sy-langu
  stsma        = lv_stsma
) TO lt_status.