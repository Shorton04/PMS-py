DATA lv_cmxs_active TYPE abap_bool VALUE abap_false.

SELECT SINGLE j~stat
  INTO @DATA(lv_cmx_stat)
  FROM jest AS j
  INNER JOIN tj30t AS t
    ON t~estat = j~stat
 WHERE j~objnr = @ps_order-objnr
   AND j~inact = ''
   AND t~txt04 = 'CMXS'
   AND t~spras = 'E'.

IF sy-subrc = 0.
  lv_cmxs_active = abap_true.
ENDIF.



DATA lv_stsma TYPE tj30-stsma.

SELECT SINGLE stsma
  INTO lv_stsma
  FROM jest
 WHERE objnr = ps_order-objnr.



IF lv_teco_active = abap_true OR lv_locked_active = abap_true.
  " bypass date filter for removal
ELSE.
  IF lv_jcds_ts IS INITIAL AND lv_cdhdr_ts IS INITIAL.
    RETURN.
  ENDIF.
ENDIF.