IF lv_locked_active = abap_true.

  " LKD → must be inside window (JCDS)
  PERFORM check_lkd_window USING ps_order CHANGING lv_in_window.
  IF lv_in_window = abap_false.
    RETURN.
  ENDIF.

ELSEIF lv_teco_active = abap_true.

  " TECO → must be inside window (JCDS)
  PERFORM check_teco_window USING ps_order CHANGING lv_in_window.
  IF lv_in_window = abap_false.
    RETURN.
  ENDIF.

ELSEIF lv_rel_active = abap_true.

  " REL logic (always include if no CMXS)
  IF lv_cmxs_active = abap_false.
    lv_in_window = abap_true.
  ELSE.
    " CDHDR window logic
  ENDIF.

ENDIF.